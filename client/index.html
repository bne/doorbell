<!doctype html>
<head>
  <title>doorbell</title>
  <link rel=stylesheet type=text/css href="css/client.css">
  <link rel=stylesheet type=text/css href="css/weather-icons.min.css">
</head>
<body>
  <div id="content">
    <div id="status"></div>
    <div id="clock"></div>
    <div id="weather" class="cf"></div>
    <div id="calendar"><button id="auth-google">Authorize</button></div>
  </div>

  <script src="js/lib/lodash.js"></script>
  <script src="js/lib/moment.js"></script>
  <script src="js/lib/jquery.js"></script>
  <script>
    var config = {
      OPEN_WEATHER_MAP_API_URL: 'http://api.openweathermap.org/data/2.5/forecast',
      OPEN_WEATHER_MAP_KEY: '7931d99df6fadc37127142e74987eb59',
      OPEN_WEATHER_MAP_LOC: '2633352',
      GOOGLE_API_KEY: 'AIzaSyDTwCiqyE9sFrnJ5jTxyeGV1YFjigp42RQ',
      GOOGLE_API_CLIENT_ID: '217718935494-2afui8u0vpnthg14b2bkahqkcv43esa5.apps.googleusercontent.com',
      GOOGLE_API_CALENDAR_ID: '305tm4ggc00k5kcftapuh16cp8@group.calendar.google.com',
      GOOGLE_API_DISCOVERY_DOCS: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
      GOOGLE_API_SCOPES: 'https://www.googleapis.com/auth/calendar.readonly',
    }
  </script>
  <script src="js/client.js"></script>
  <script src="https://apis.google.com/js/client.js?onload=initCalendar"></script>

  <script type="text/template" id="tmpl-clock">
    <div class="time"><%-now.format('HH:mm') %></div>
    <div class="day"><%-now.format('dddd') %></div>
    <div class="date">
      <span class="d"><%-now.format('Do') %></span>
      <span class="m"><%-now.format('MMMM') %></span>
      <span class="y"><%-now.format('YYYY') %></span>
    </div>
  </script>

  <script type="text/template" id="tmpl-weather">
    <% _.each(forecast, function({ temp, description, icon }, i) { %>
      <div class="forecast <%- i === 0 ? 'current cf' : '' %>">
        <div class="info">
          <div class="temp"><%-temp %>&deg;C</div>
          <% if(i === 0) { %>
            <div class="description"><%-description %></div>
          <% } %>
        </div>
        <div class="icon"><i class="wi <%-icon %>"></i></div>
      </div>
    <% }); %>
  </script>

  <script type="text/template" id="tmpl-calendar">
    <% _.each(days, function(day) { %>
      <section><%-moment(parseInt(day)).format('dddd Do MMMM') %></section>
      <ul class="calendar-items">
      <% _.each(dayGroups[day], function(item) { %>
        <li>
          <% if(item.start.dateTime) { %>
            <strong><%-moment(item.start.dateTime).format('HH:mm') %></strong> -
          <% } %>
          <%-item.summary %>
        </li>
      <% }); %>
      </ul>
    <% }); %>
  </script>
</body>